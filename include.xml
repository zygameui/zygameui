<?xml version="1.0" encoding="utf-8"?>
<project>
	<!-- 原始实现 -->
	<source path="Source" />
	<haxelib name="openfl" />
	<!-- DPI自动感知行为，9.2.1的新DPI如果不开启会导致显示异常，开启后，可能会使内存增加 -->
	<!-- <define name="openfl_dpi_aware" if="${openfl >= 9.2.0} || focre_openfl_dpi_aware"/> -->
	<!-- <haxelib name="openfl-dev-8.9.6" if="openfl8"/> -->
	<section unless="unable_swf">
		<haxelib name="swf" if="${openfl >= 9.0.0}" />
		<!-- OpenFL9兼容8.9.0的代码 -->
		<source path="openfl9-source" if="${openfl >= 9.0.0}" />
	</section>
	<!-- 新增openfl-console支持 -->
	<section if="openfl-console">
		<haxelib name="openfl-console" />
		<haxeflag name="--macro" value="addGlobalMetadata('', '@:rtti')" />
	</section>
	<section if="embed_optional">
		<!-- HScript脚本 -->
		<haxelib name="hscript" />
		<!-- 静态数据类 -->
		<haxelib name="castle" />
		<!-- 编码库 -->
		<haxelib name="crypto" />
		<!-- SWF -->
		<haxelib name="swf" />
	</section>
	<!-- Spine锁定版本3.8.1 -->
	<haxelib name="spine-hx" version="3.8.1" if="spine3.8" />
	<haxelib name="spine-hx" version="3.6.0" unless="spine3.8" />
	<haxedef name="spine38" if="spine3.8" />
	<haxelib name="tweenxcore" />
	<haxelib name="actuate" />

	<define name="message-reporting" value="pretty"/>

	<!-- 无物理系统碰撞类 -->
	<haxelib name="differ" />
	<haxelib name="zygameui-nape" if="nape" />
	<!-- GLSL -->
	<haxelib name="vector-math" />
	<haxelib name="openfl-glsl" />
	<!-- GPU粒子库 -->
	<haxelib name="openfl-gpu-particles" />

	<!-- 禁止字体缩放 -->
	<haxedef name="un_scale_label" unless="high_label" />

	<!-- zygameui框架标示 -->
	<haxedef name="zygame" />
	<define name="zygame" />
	<haxelib name="openfl-spine" />

	<!-- 编译平台的自动引入处理 -->
	<include path="platforms.xml" />

	<!-- IOS的一些修复 -->
	<haxedef name="ios_render_fix" if="ios || ks" />

	<!-- C++测试模块 -->
	<haxedef name="debuginput" if="debug cpp !ios" />
	<haxedef name="debugnetwork" if="debug cpp !ios" />

	<!-- 即使在发布模式下，也要在最终二进制文件中添加符号。 -->
	<define name="HXCPP_DEBUG_LINK" />
	<!-- 即使在发布模式下，也具有有效的功能级堆栈跟踪。 -->
	<define name="HXCPP_STACK_TRACE" />
	<!-- 即使在发布模式下，也将行信息包括在堆栈跟踪中。 -->
	<define name="HXCPP_STACK_LINE" />
	<define name="HXCPP_CHECK_POINTER" />

	<!-- HTML5 CPP 默认开始高清模式 -->
	<window allow-high-dpi="true" vsync="true" if="cpp || hl || html5" />

	<!-- 默认平滑 -->
	<haxedef name="smoothing" if="cpp" unless="unsmoothing" />

	<!-- 禁止图形使用软件刷新，使用OpenFL9将不再限制，但是在Android和IOS上遇到了一些布局错误的问题 -->
	<!-- <define name="openfl-disable-graphics-upscaling" if="${9.0.0 > openfl} || android || ios" /> -->

	<!-- 新增对openflswf的支持 -->
	<define name="openfl_swf" />

	<haxedef name="invalidate" if="android || hl" />

	<!-- HTML5的模板 -->
	<!-- <template path="index.html"/> -->
	<template path="template-html5/template/index.html" rename="index.html" unless="minigame" />

	<!-- IOS以及Android进行64位支持 -->
	<architecture name="arm64" exclude="armv7" if="ios" />
	<architecture name="armv7" exclude="arm64" if="android" unless="final" />
	<!-- <architecture name="armv7" exclude="arm64" if="android" unless="final"/> -->
	<!-- <architecture name="arm64" if="android final" /> -->
	<!-- 安卓只要v7 -->
	<!-- <architecture name="armv7" exclude="arm64" if="android" /> -->
	<!-- <architecture name="arm64" exclude="armv7" if="android" /> -->

	<!-- 测试 -->
	<!-- <haxeflag name="-dce" value="full" /> -->
	<haxeflag name='--macro keep("openfl.display.DisplayObject")' />
	<haxeflag name='--macro keep("openfl.display.DisplayObjectContainer")' />
	<haxeflag name='--macro keep("openfl.display.Sprite")' />
	<haxeflag name='--macro keep("zygame.display.batch.BLabel")' />
	<haxeflag name='--macro keep("openfl.geom.Point")' />
	<haxeflag name='--macro keep("zygame.display.batch.BDisplayObject")' />
	<haxeflag name='--macro keep("zygame.display.DisplayObject")' />
	<haxeflag name='--macro keep("zygame.display.DisplayObjectContainer")' />
	<haxeflag name='--macro keep("zygame.display.batch.BDisplayObjectContainer")' />
	<haxeflag name='--macro keep("game.core.display.WipeImage")' />
	<haxeflag name='--macro keep("zygame.components.ZImage")' />
	<haxeflag name='--macro keep("zygame.components.ZAnimation")' />
	<haxeflag name='--macro keep("zygame.mini.MiniEngineScene")' />
	<haxeflag name='--macro keep("zygame.mini.MiniEngineAssets")' />
	<haxeflag name='--macro keep("openfl.ui.Multitouch")' />
	<haxeflag name='--macro keep("spine.AnimationStateData")' />
	<haxeflag name='--macro keep("spine.Key")' />
	<haxeflag name='--macro keep("spine.Skin")' />
	<haxeflag name='--macro keep("spine.support.extensions.SpineExtensions")' />
	<haxeflag name='--macro keep("spine.support.extensions.StringExtensions")' />
	<haxeflag name='--macro keep("tweenxcore.Tools")' />
	<haxeflag name='--macro keep("tweenxcore.Tools.Easing")' />
	<haxeflag name='--macro keep("tweenxcore.Tools.FloatTools")' />
	<haxeflag name='--macro keep("tweenxcore.Tools.PointTools")' />
	<haxeflag name='--macro keep("tweenxcore.Tools.MatrixTools")' />
	<haxeflag name='--macro keep("tweenxcore.Easing")' />
	<haxeflag name='--macro keep("tweenxcore.FloatTools")' />
	<haxeflag name='--macro keep("tweenxcore.PointTools")' />
	<haxeflag name='--macro keep("tweenxcore.MatrixTools")' />

	<!-- 宏耗时输出 -->
	<!-- <haxeflag name='\-\-times' />
	<define name="macro_times"/> -->

	<!-- 发布最终版时，会移除所有trace语句，提高性能 -->
	<haxeflag name="--no-traces" if="final-no-traces" />

	<!-- HLCheak  -->
	<haxeflag name="-D" value="hl-check" if="hl" />

	<!-- 开启ES6 -->
	<define name="es" value="6" if="js"/>

	<!-- 默认启动GPU粒子 -->
	<haxedef name="gpu_particles" unless="cpu_particles" />

</project>